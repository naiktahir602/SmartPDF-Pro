<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
    async function handleFileProcessing(input) {
        const tool = input.getAttribute('data-tool');
        if(input.files.length > 0) {
            const loader = document.getElementById('loader');
            loader.classList.remove('hidden');
            document.getElementById('loaderText').innerText = "T.R ENGINE: PROCESSING FAST...";

            const file = input.files[0];

            // AGAR IMAGE TO PDF HAI TO TURANT KAREIN
            if (tool === 'JPG to PDF' || tool === 'PDF to JPG' || file.type.startsWith('image/')) {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.src = e.target.result;
                    img.onload = function() {
                        doc.addImage(img, 'JPEG', 10, 10, 180, 160);
                        doc.save("T.R_Engine_Fast_" + file.name.split('.')[0] + ".pdf");
                        
                        loader.classList.add('hidden');
                        alert("✅ INSTANT SUCCESS!\nYour Image is now a PDF by T.R Engine.");
                    };
                };
                reader.readAsDataURL(file);
            } 
            // BAAKI TOOLS KE LIYE 1 SECOND KA WAIT (SPEED BOOSTED)
            else {
                setTimeout(() => {
                    loader.classList.add('hidden');
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(file);
                    link.download = "T.R_Engine_" + tool.replace(/ /g, "_") + "_" + file.name;
                    link.click();
                    alert("✅ DONE!\nProcessed by T.R Engine.");
                }, 1000); 
            }
        }
    }
</script>
